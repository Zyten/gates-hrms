!function(o){o.isScrollToFixed=function(i){return!!o(i).data("ScrollToFixed")},o.ScrollToFixed=function(i,e){function t(){m.trigger("preUnfixed.ScrollToFixed"),p(),m.trigger("unfixed.ScrollToFixed"),O=-1,w=m.offset().top,v=m.offset().left,F.options.offsets&&(v+=m.offset().left-m.position().left),-1==U&&(U=v),T=m.css("position"),h=!0,-1!=F.options.bottom&&(m.trigger("preFixed.ScrollToFixed"),d(),m.trigger("fixed.ScrollToFixed"))}function n(){var o=F.options.limit;return o?"function"==typeof o?o.apply(m):o:0}function r(){return"fixed"===T}function l(){return"absolute"===T}function s(){return!(r()||l())}function d(){r()||(y.css({display:m.css("display"),width:m.outerWidth(!0),height:m.outerHeight(!0),"float":m.css("float")}),cssOptions={position:"fixed",top:-1==F.options.bottom?f():"",bottom:-1==F.options.bottom?"":F.options.bottom,"margin-left":"0px"},F.options.dontSetWidth||(cssOptions.width=m.width()),m.css(cssOptions),m.addClass("scroll-to-fixed-fixed"),F.options.className&&m.addClass(F.options.className),T="fixed")}function c(){var o=n(),i=v;F.options.removeOffsets&&(i="",o-=w),cssOptions={position:"absolute",top:o,left:i,"margin-left":"0px",bottom:""},F.options.dontSetWidth||(cssOptions.width=m.width()),m.css(cssOptions),T="absolute"}function p(){s()||(O=-1,y.css("display","none"),m.css({width:"",position:S,left:"",top:b,"margin-left":""}),m.removeClass("scroll-to-fixed-fixed"),F.options.className&&m.removeClass(F.options.className),T=null)}function x(o){o!=O&&(m.css("left",v-o),O=o)}function f(){var o=F.options.marginTop;return o?"function"==typeof o?o.apply(m):o:0}function u(){if(o.isScrollToFixed(m)){var i=h;h||t();var e=o(window).scrollLeft(),u=o(window).scrollTop(),T=n();F.options.minWidth&&o(window).width()<F.options.minWidth?s()&&i||(g(),m.trigger("preUnfixed.ScrollToFixed"),p(),m.trigger("unfixed.ScrollToFixed")):F.options.maxWidth&&o(window).width()>F.options.maxWidth?s()&&i||(g(),m.trigger("preUnfixed.ScrollToFixed"),p(),m.trigger("unfixed.ScrollToFixed")):-1==F.options.bottom?T>0&&u>=T-f()?l()&&i||(g(),m.trigger("preAbsolute.ScrollToFixed"),c(),m.trigger("unfixed.ScrollToFixed")):u>=w-f()?(r()&&i||(g(),m.trigger("preFixed.ScrollToFixed"),d(),O=-1,m.trigger("fixed.ScrollToFixed")),x(e)):s()&&i||(g(),m.trigger("preUnfixed.ScrollToFixed"),p(),m.trigger("unfixed.ScrollToFixed")):T>0?u+o(window).height()-m.outerHeight(!0)>=T-(f()||-a())?r()&&(g(),m.trigger("preUnfixed.ScrollToFixed"),"absolute"===S?c():p(),m.trigger("unfixed.ScrollToFixed")):(r()||(g(),m.trigger("preFixed.ScrollToFixed"),d()),x(e),m.trigger("fixed.ScrollToFixed")):x(e)}}function a(){return F.options.bottom?F.options.bottom:0}function g(){var o=m.css("position");"absolute"==o?m.trigger("postAbsolute.ScrollToFixed"):"fixed"==o?m.trigger("postFixed.ScrollToFixed"):m.trigger("postUnfixed.ScrollToFixed")}var F=this;F.$el=o(i),F.el=i,F.$el.data("ScrollToFixed",F);var T,S,b,h=!1,m=F.$el,w=0,v=0,U=-1,O=-1,y=null,A=function(o){m.is(":visible")&&(h=!1,u())},C=function(o){u()},W=function(o){o=o||window.event,o.preventDefault&&o.preventDefault(),o.returnValue=!1};F.init=function(){F.options=o.extend({},o.ScrollToFixed.defaultOptions,e),F.$el.css("z-index",F.options.zIndex),y=o("<div />"),T=m.css("position"),S=m.css("position"),b=m.css("top"),s()&&F.$el.after(y),o(window).bind("resize.ScrollToFixed",A),o(window).bind("scroll.ScrollToFixed",C),F.options.preFixed&&m.bind("preFixed.ScrollToFixed",F.options.preFixed),F.options.postFixed&&m.bind("postFixed.ScrollToFixed",F.options.postFixed),F.options.preUnfixed&&m.bind("preUnfixed.ScrollToFixed",F.options.preUnfixed),F.options.postUnfixed&&m.bind("postUnfixed.ScrollToFixed",F.options.postUnfixed),F.options.preAbsolute&&m.bind("preAbsolute.ScrollToFixed",F.options.preAbsolute),F.options.postAbsolute&&m.bind("postAbsolute.ScrollToFixed",F.options.postAbsolute),F.options.fixed&&m.bind("fixed.ScrollToFixed",F.options.fixed),F.options.unfixed&&m.bind("unfixed.ScrollToFixed",F.options.unfixed),F.options.spacerClass&&y.addClass(F.options.spacerClass),m.bind("resize.ScrollToFixed",function(){y.height(m.height())}),m.bind("scroll.ScrollToFixed",function(){m.trigger("preUnfixed.ScrollToFixed"),p(),m.trigger("unfixed.ScrollToFixed"),u()}),m.bind("detach.ScrollToFixed",function(i){W(i),m.trigger("preUnfixed.ScrollToFixed"),p(),m.trigger("unfixed.ScrollToFixed"),o(window).unbind("resize.ScrollToFixed",A),o(window).unbind("scroll.ScrollToFixed",C),m.unbind(".ScrollToFixed"),y.remove(),F.$el.removeData("ScrollToFixed")}),A()},F.init()},o.ScrollToFixed.defaultOptions={marginTop:0,limit:0,bottom:-1,zIndex:1e3},o.fn.scrollToFixed=function(i){return this.each(function(){new o.ScrollToFixed(this,i)})}}(jQuery);